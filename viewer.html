<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>PPT查看器 · 彩凤鸣岐</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>📖 PPT 查看器</h1>
    <a href="index.html" class="back">返回主页</a>
  </header>

  <main class="viewer">
    <iframe id="ppt-viewer" width="100%" height="600px" frameborder="0"></iframe>
  </main>

  <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";
    const SUPABASE_URL = "https://cgfzogwhglbvgfppyhpc.supabase.co";
    const SUPABASE_ANON_KEY = "sb_publishable_srnrQzpnFTlsVaCTylDm3A_mzheWcyv";
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const params = new URLSearchParams(window.location.search);
    const file = params.get("file");

    if (file) {
      const { data } = await supabase.storage
        .from("ppt-files")
        .getPublicUrl(file);
      document.getElementById("ppt-viewer").src =
        "https://view.officeapps.live.com/op/embed.aspx?src=" + encodeURIComponent(data.publicUrl);
    }
  </script>
</body>
</html>
